# 指令训练平台 - 一键启动说明

## 概述

本项目提供了一键启动脚本，在单个窗口中按顺序自动启动Rasa服务、后端服务和前端服务。所有服务将在后台运行，启动过程清晰可见。

## 启动脚本

### 1. Windows批处理版本 (推荐) 🚀
```bash
# 双击运行或在命令行执行
start_all_services.bat
```

### 2. Python跨平台版本
```bash
# 在命令行执行
python start_all_services.py
```

## ✨ 新功能特性

### 顺序启动
- **智能顺序**: Rasa → 后端 → 前端，确保依赖关系正确
- **单窗口操作**: 所有启动过程在一个窗口中完成
- **进度显示**: 7步详细启动流程，每步都有清晰提示

### 环境检查
- **全面检测**: 自动检查Python、Node.js环境
- **依赖验证**: 检查虚拟环境、node_modules等必要组件
- **错误提示**: 详细的错误信息和解决建议

### 状态监控
- **实时检查**: 启动后自动检查每个服务的运行状态
- **健康状态**: 使用curl检测服务是否正常响应
- **状态报告**: 最终显示所有服务的运行状态

## 启动顺序

脚本会在**单个窗口**中按以下顺序启动服务：

1. **Rasa服务** (端口: 5005) - 优先启动
   - 位置: `start_rasa_gpu.py`
   - 使用GPU加速训练
   - 等待时间: 15秒（首次运行可能更长）
   - 后台运行

2. **后端服务** (端口: 8081)
   - 位置: `backend/app.py`
   - 激活虚拟环境: `backend/venv`
   - 等待时间: 8秒
   - 后台运行

3. **前端服务** (端口: 3000)
   - 位置: `frontend/`
   - 使用React开发服务器
   - 等待时间: 10秒
   - 后台运行

## 访问地址

启动完成后，可以通过以下地址访问各服务：

- **前端界面**: http://localhost:3000
- **后端API**: http://localhost:8081
- **API文档**: http://localhost:8081/docs
- **Rasa API**: http://localhost:5005

## 环境要求

### 必需环境
- Windows 10/11
- Python 3.8+
- Node.js 14+

### Python依赖
```bash
cd backend
python -m venv venv
venv\Scripts\activate  # Windows
pip install -r requirements.txt
```

### Node.js依赖
```bash
cd frontend
npm install
```

## 停止服务

### 方法1: 使用停止脚本
```bash
stop_all_services.bat
```

### 方法2: 手动关闭窗口
分别关闭启动的三个命令行窗口：
- 后端服务窗口
- Rasa服务窗口  
- 前端服务窗口

### 方法3: 任务管理器
在Windows任务管理器中结束以下进程：
- node.exe (前端)
- python.exe (后端和Rasa)

## 故障排除

### 常见问题

1. **Python环境未找到**
   - 确保Python已安装并添加到PATH
   - 检查命令: `python --version`

2. **Node.js环境未找到**
   - 确保Node.js已安装并添加到PATH
   - 检查命令: `node --version`

3. **虚拟环境未找到**
   ```bash
   cd backend
   python -m venv venv
   venv\Scripts\activate
   pip install -r requirements.txt
   ```

4. **Node.js依赖未安装**
   ```bash
   cd frontend
   npm install
   ```

5. **端口被占用**
   - 使用停止脚本自动清理
   - 或手动检查: `netstat -ano | findstr :8081`

### 手动启动（调试用）

如果自动启动失败，可以手动逐个启动服务：

1. **启动后端**
   ```bash
   cd backend
   venv\Scripts\activate
   python app.py
   ```

2. **启动Rasa**
   ```bash
   python start_rasa_gpu.py
   ```

3. **启动前端**
   ```bash
   cd frontend
   npm start
   ```

## 开发模式

### 热重载
- 前端: 支持热重载，修改代码后自动刷新
- 后端: 使用uvicorn的reload模式，修改代码后自动重启
- Rasa: 需要手动重新训练模型

### 调试
- 前端: 使用浏览器开发者工具
- 后端: 查看API文档 http://localhost:8081/docs
- Rasa: 使用Rasa X或直接测试API

### 单窗口顺序启动
- **统一界面**: 所有服务在一个窗口中顺序启动
- **实时反馈**: 显示每个服务的启动进度和状态
- **状态检查**: 自动检查每个服务的运行状态
- **后台运行**: 所有服务启动后在后台运行

## 生产部署

生产环境建议使用以下配置：

1. **后端**: 使用Gunicorn + Nginx
2. **前端**: 构建静态文件部署到Nginx
3. **Rasa**: 使用Docker容器部署
4. **数据库**: 使用PostgreSQL替代SQLite

## 技术支持

如遇到问题，请检查：
1. 环境要求是否满足
2. 依赖是否正确安装
3. 端口是否被占用
4. 防火墙设置是否正确

更多详细信息请参考项目文档：
- 技术设计方案.md
- 部署指南.md
- Rasa详细使用指南.md

## 版本说明

- **v1.0**: 基础批处理版本
- **v2.0**: 添加Python跨平台版本
- **v3.0**: 简化版本，专注于稳定性和易用性 ✨ 