# 指令训练平台 - 一键启动说明

## 概述

本项目提供了一键启动脚本，可以按顺序自动启动后端服务、Rasa服务和前端服务。

## 启动脚本

### 1. Windows批处理版本 (推荐)
```bash
# 双击运行或在命令行执行
start_all_services.bat
```

### 2. Python跨平台版本
```bash
# 在命令行执行
python start_all_services.py
```

## 启动顺序

脚本会按以下顺序启动服务：

1. **后端服务** (端口: 8000)
   - 位置: `backend/app.py`
   - 使用虚拟环境: `backend/venv`
   - 等待时间: 10秒

2. **Rasa服务** (端口: 5005)
   - 位置: `start_rasa_gpu.py`
   - 使用GPU加速训练
   - 等待时间: 15秒

3. **前端服务** (端口: 3000)
   - 位置: `frontend/`
   - 使用React开发服务器
   - 等待时间: 10秒

## 访问地址

启动完成后，可以通过以下地址访问各服务：

- **前端界面**: http://localhost:3000
- **后端API**: http://localhost:8000
- **API文档**: http://localhost:8000/docs
- **Rasa API**: http://localhost:5005

## 环境要求

### 必需环境
- Python 3.8+
- Node.js 14+
- Git

### Python依赖
```bash
cd backend
python -m venv venv
venv\Scripts\activate  # Windows
# source venv/bin/activate  # Linux/Mac
pip install -r requirements.txt
```

### Node.js依赖
```bash
cd frontend
npm install
```

## 停止服务

### 方法1: 使用停止脚本
```bash
# Windows
stop_all_services.bat
```

### 方法2: 手动关闭
分别关闭启动的三个命令行窗口：
- 后端服务窗口
- Rasa服务窗口  
- 前端服务窗口

### 方法3: 任务管理器
在Windows任务管理器中结束以下进程：
- node.exe (前端)
- python.exe (后端和Rasa)

## 故障排除

### 常见问题

1. **Python环境未找到**
   - 确保Python已安装并添加到PATH
   - 检查命令: `python --version`

2. **Node.js环境未找到**
   - 确保Node.js已安装并添加到PATH
   - 检查命令: `node --version`

3. **虚拟环境未找到**
   ```bash
   cd backend
   python -m venv venv
   venv\Scripts\activate
   pip install -r requirements.txt
   ```

4. **Node.js依赖未安装**
   ```bash
   cd frontend
   npm install
   ```

5. **端口被占用**
   - 检查端口占用: `netstat -ano | findstr :8000`
   - 结束占用进程: `taskkill /f /pid <PID>`

6. **服务启动失败**
   - 查看各服务窗口的错误信息
   - 检查日志文件:
     - 后端: `backend/logs/system.log`
     - Rasa: `rasa/logs/system.log`

### 手动启动（调试用）

如果自动启动失败，可以手动逐个启动服务：

1. **启动后端**
   ```bash
   cd backend
   venv\Scripts\activate
   python app.py
   ```

2. **启动Rasa**
   ```bash
   python start_rasa_gpu.py
   ```

3. **启动前端**
   ```bash
   cd frontend
   npm start
   ```

## 开发模式

### 热重载
- 前端: 支持热重载，修改代码后自动刷新
- 后端: 使用uvicorn的reload模式，修改代码后自动重启
- Rasa: 需要手动重新训练模型

### 调试
- 前端: 使用浏览器开发者工具
- 后端: 查看API文档 http://localhost:8000/docs
- Rasa: 使用Rasa X或直接测试API

## 生产部署

生产环境建议使用以下配置：

1. **后端**: 使用Gunicorn + Nginx
2. **前端**: 构建静态文件部署到Nginx
3. **Rasa**: 使用Docker容器部署
4. **数据库**: 使用PostgreSQL替代SQLite

## 技术支持

如遇到问题，请检查：
1. 环境要求是否满足
2. 依赖是否正确安装
3. 端口是否被占用
4. 防火墙设置是否正确

更多详细信息请参考项目文档：
- 技术设计方案.md
- 部署指南.md
- Rasa详细使用指南.md 