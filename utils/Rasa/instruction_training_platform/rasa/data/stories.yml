version: "3.1"

stories:

# 基础对话
- story: 简单问候
  steps:
    - intent: greet
    - action: utter_greet

- story: 问候后询问帮助
  steps:
    - intent: greet
    - action: utter_greet
    - intent: ask_help
    - action: utter_ask_help

- story: 简单告别
  steps:
    - intent: goodbye
    - action: utter_goodbye

# 表单流程标准化
- story: 预订航班流程
  steps:
    - intent: book_flight
    - action: utter_book_flight
    - action: flight_booking_form       # 表单动作事件
    - active_loop: flight_booking_form  # 表单激活
    # 槽位填充（简化）
    - intent: inform
      entities: [departure_city: "北京"]
    - slot_was_set: [departure_city]
    - intent: inform
      entities: [arrival_city: "上海"]
    - slot_was_set: [arrival_city]
    - intent: inform
      entities: [travel_date: "明天"]
    - slot_was_set: [travel_date]
    - intent: inform
      entities: [passenger_name: "张三"]
    - slot_was_set: [passenger_name]
    - active_loop: null  # 表单失活
    - action: action_book_flight

# 使用 OR 语句合并分支
- story: 预订后中断处理
  steps:
    - intent: book_flight
    - action: utter_book_flight
    - or:
        - intent: goodbye     # 分支1：告别
        - intent: deny        # 分支2：否认
    - action: utter_interrupt # 通用响应

# 其他故事保持不变（天气、身份确认等）
- story: 询问天气
  steps:
    - intent: ask_weather
    - action: utter_ask_weather

- story: 取消预订流程
  steps:
    - intent: cancel_booking
    - action: utter_cancel_booking
    - intent: inform
      entities: [booking_id: "ABC123"]
    - action: action_cancel_booking